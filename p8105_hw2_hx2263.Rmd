---
title: "p8105_hw2_hx2263"
author: "Tiffany Xi"
date: 2018-09-27
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

##Problem 1

**Import and clean NYC transit csv files**

```{r}
nyc_transit = 
  read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, station_longitude, starts_with("route"), entry,          vending, entrance_type, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
nyc_transit
```

*Description:*

This nyc_transit dataset contains variables named `r colnames(nyc_transit)`. 

My data cleaning steps are: first clean the column names into snake case with function janitor::clean_names; then use 'select' function to select the variables I am interested in. Subsequently, use recode to convert the character variable 'YES' and 'NO' in 'entry' column into logical variable 'TRUE' and 'FALSE'.

The dimension of the resulting dataset is `r nrow(nyc_transit)`*`r ncol(nyc_transit)`.

*Answers:*

1.There are `r nrow(distinct(nyc_transit, line, station_name))` distinct stations.

**filter out the ADA complicant distinct stations**

```{r}
ada_nyc_transit = 
  nyc_transit %>% 
  distinct(line, station_name, .keep_all = TRUE) %>% 
  filter(ada == "TRUE")
```
2.The number of stations which are ADA compliant is `r nrow(ada_nyc_transit)`.
 
```{r}
vend_nyc_transit =
  nyc_transit %>%
  filter(vending == 'NO')
nrow(vend_nyc_transit)/nrow(nyc_transit)
```

Reformat the data

1.route number and route name are distinct variables
```{r}
nyc_transit_tidy = 
  nyc_transit%>% 
  gather(key = "route_number", value = "route_name", route1:route11)
```

2.find out the distinct stations serve the A train
```{r}
nyc_transit_tidy_a = 
  nyc_transit_tidy %>% 
  distinct(line, station_name, .keep_all = TRUE) %>% 
  filter(route_name == "A")
```

`r nrow(nyc_transit_tidy_a)` distinct stations serve the A train.

```{r}
nyc_transit_tidy_a_ada = 
  nyc_transit_tidy_a %>% 
  filter(ada == "TRUE")
```

Of the stations that serve the A train, `r nrow(nyc_transit_tidy_a_ada)` of them are ADA compliant.


##Problem 2

1.Read and clean the Mr. Trash Wheel sheet.

```{r}
trash_wheel = 
  readxl::read_excel(path = "./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
                     sheet = "Mr. Trash Wheel", 
                     range = "A2:N258") %>%
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(sports_balls = round(sports_balls, digits = 0)) %>% 
  mutate(sports_balls = as.integer(sports_balls))
trash_wheel
```

2.Read and clean precipitation data for 2016 and 2017

```{r}
prcp_2016 = 
  readxl::read_excel(path = "./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                     sheet = "2016 Precipitation", 
                     range = "A2:B15") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(month)) %>% 
  filter(!is.na(total)) %>% 
  mutate(year = 2016) 

prcp_2016

prcp_2017 = 
  readxl::read_excel(path = "./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                     sheet = "2017 Precipitation", 
                     range = "A2:B15") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(month)) %>% 
  filter(!is.na(total)) %>% 
  mutate(year = 2017) 

prcp_2017
```

3.Combine datasets and convert month to a character variable

```{r}
prcp_2016 = mutate(prcp_2016, month = month.name)
prcp_2017 = mutate(prcp_2017, month = month.name[0:nrow(prcp_2017)])
combo_16_17 = full_join(prcp_2016, prcp_2017)
combo_16_17
```

```{r}
combo_16_17_trash = full_join(combo_16_17, trash_wheel, by = c("month", "year"))
combo_16_17_trash
```

the number of observations in both resulting datasets are `r nrow(trash_wheel)` and `r nrow(combo_16_17)`, and give examples of key variables. 

For available data, the total precipitation in 2017 was `r sum(prcp_2017$total[prcp_2017$year == "2017"])`.

```{r include = FALSE}
trash_wheel_2016 = filter(trash_wheel, trash_wheel$year == 2016)
```

The median number of sports balls in a dumpster in 2016 was `r median(trash_wheel_2016$dumpster)`.





