p8105\_hw2\_hx2263
================
Tiffany Xi
2018-09-27

Problem 1
=========

**Import and clean NYC transit csv files**

``` r
nyc_transit = 
  read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, station_longitude, starts_with("route"), entry,          vending, entrance_type, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```

*Description:*

This nyc\_transit dataset contains variables named line, station\_name, station\_latitude, station\_longitude, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, entry, vending, entrance\_type, ada.

My data cleaning steps are: first clean the column names into snake case with function janitor::clean\_names; then use 'select' function to select the variables I am interested in. Subsequently, use recode to convert the character variable 'YES' and 'NO' in 'entry' column into logical variable 'TRUE' and 'FALSE'.

The dimension of the resulting dataset is 1868 \* 19. I think these data are untidy, we need to put all routes into one column.

-   Answers:

1.  There are 465 distinct stations.

2.  The number of stations which are ADA compliant is 84.

3.  The proportion of station entrances / exits without vending allow entrance is 0.3770492.

-   Reformat data

*1.* route number and route name are distinct variables

``` r
nyc_transit_tidy = 
  nyc_transit %>% 
  gather(key = "route_number", value = "route_name", route1:route11) %>% 
  separate(route_number, into = c("route_str", "route_num"), sep = 5) %>% 
  select(-route_str)
nyc_transit_tidy
```

    ## # A tibble: 20,548 x 10
    ##    line  station_name station_latitude station_longitu… entry vending
    ##    <chr> <chr>                   <dbl>            <dbl> <lgl> <chr>  
    ##  1 4 Av… 25th St                  40.7            -74.0 TRUE  YES    
    ##  2 4 Av… 25th St                  40.7            -74.0 TRUE  YES    
    ##  3 4 Av… 36th St                  40.7            -74.0 TRUE  YES    
    ##  4 4 Av… 36th St                  40.7            -74.0 TRUE  YES    
    ##  5 4 Av… 36th St                  40.7            -74.0 TRUE  YES    
    ##  6 4 Av… 45th St                  40.6            -74.0 TRUE  YES    
    ##  7 4 Av… 45th St                  40.6            -74.0 TRUE  YES    
    ##  8 4 Av… 45th St                  40.6            -74.0 TRUE  YES    
    ##  9 4 Av… 45th St                  40.6            -74.0 TRUE  YES    
    ## 10 4 Av… 53rd St                  40.6            -74.0 TRUE  YES    
    ## # ... with 20,538 more rows, and 4 more variables: entrance_type <chr>,
    ## #   ada <lgl>, route_num <chr>, route_name <chr>

*2.* 60 distinct stations serve the A train.

``` r
nyc_transit_tidy_a_ada = 
  nyc_transit_tidy %>% 
  distinct(line, station_name, .keep_all = TRUE) %>% 
  filter(route_name == "A") %>% 
  filter(ada == "TRUE")
```

*3.* Of the stations that serve the A train, 17 of them are ADA compliant.

Problem 2
=========

1.Read and clean the Mr. Trash Wheel sheet.

``` r
trash_wheel = 
  readxl::read_excel(path = "./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
                     sheet = "Mr. Trash Wheel", 
                     range = "A2:N258") %>%
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(sports_balls = round(sports_balls, digits = 0)) %>% 
  mutate(sports_balls = as.integer(sports_balls))
trash_wheel
```

    ## # A tibble: 215 x 14
    ##    dumpster month  year date                weight_tons volume_cubic_ya…
    ##       <dbl> <chr> <dbl> <dttm>                    <dbl>            <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00        4.31               18
    ##  2        2 May    2014 2014-05-16 00:00:00        2.74               13
    ##  3        3 May    2014 2014-05-16 00:00:00        3.45               15
    ##  4        4 May    2014 2014-05-17 00:00:00        3.1                15
    ##  5        5 May    2014 2014-05-17 00:00:00        4.06               18
    ##  6        6 May    2014 2014-05-20 00:00:00        2.71               13
    ##  7        7 May    2014 2014-05-21 00:00:00        1.91                8
    ##  8        8 May    2014 2014-05-28 00:00:00        3.7                16
    ##  9        9 June   2014 2014-06-05 00:00:00        2.52               14
    ## 10       10 June   2014 2014-06-11 00:00:00        3.76               18
    ## # ... with 205 more rows, and 8 more variables: plastic_bottles <dbl>,
    ## #   polystyrene <dbl>, cigarette_butts <dbl>, glass_bottles <dbl>,
    ## #   grocery_bags <dbl>, chip_bags <dbl>, sports_balls <int>,
    ## #   homes_powered <dbl>

2.Read and clean precipitation data for 2016 and 2017

``` r
prcp_2016 = 
  readxl::read_excel(path = "./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                     sheet = "2016 Precipitation", 
                     range = "A2:B15") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(month)) %>% 
  filter(!is.na(total)) %>% 
  mutate(year = 2016) 

prcp_2017 = 
  readxl::read_excel(path = "./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                     sheet = "2017 Precipitation", 
                     range = "A2:B15") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(month)) %>% 
  filter(!is.na(total)) %>% 
  mutate(year = 2017) 
```

3.Combine datasets and convert month to a character variable

``` r
prcp_2016 = mutate(prcp_2016, month = month.name)
prcp_2017 = mutate(prcp_2017, month = month.name[0:nrow(prcp_2017)])
combo_16_17 = full_join(prcp_2016, prcp_2017)
```

    ## Joining, by = c("month", "total", "year")

``` r
combo_16_17
```

    ## # A tibble: 20 x 3
    ##    month     total  year
    ##    <chr>     <dbl> <dbl>
    ##  1 January    3.23  2016
    ##  2 February   5.32  2016
    ##  3 March      2.24  2016
    ##  4 April      1.78  2016
    ##  5 May        5.19  2016
    ##  6 June       3.2   2016
    ##  7 July       6.09  2016
    ##  8 August     3.96  2016
    ##  9 September  4.53  2016
    ## 10 October    0.62  2016
    ## 11 November   1.47  2016
    ## 12 December   2.32  2016
    ## 13 January    2.34  2017
    ## 14 February   1.46  2017
    ## 15 March      3.57  2017
    ## 16 April      3.99  2017
    ## 17 May        5.64  2017
    ## 18 June       1.4   2017
    ## 19 July       7.09  2017
    ## 20 August     4.44  2017

combo\_16\_17\_trash = full\_join(combo\_16\_17, trash\_wheel, by = c("month", "year"))
=======================================================================================

combo\_16\_17\_trash
====================

-   The number of observations in both resulting datasets are 215 and 20, and give examples of key variables.

*KEY VARIABLES * For available data, the total precipitation in 2017 was 29.93 inches.

-   The median number of sports balls in a dumpster in 2016 was 26.

Problem 3
=========

``` r
library(p8105.datasets)
brfss = brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health") %>% 
  select(-class, -topic, -question, -sample_size, -(confidence_limit_low:geo_location))%>%
  spread(key = response, value = data_value) %>%
  janitor::clean_names() %>% 
  select("year", "locationabbr", "locationdesc", "excellent", "very_good", "good", "fair", "poor") %>% 
  mutate(prop = (excellent + very_good))
```

which.max(table(brfss$locationabbr))
====================================

-   404 unique locations are included in the dataset. The number of states are 51, so, yes, every state is represented. NJ(New Jersey) is observed the most.

-   In 2002, the median of the “Excellent” response value is 23.6.

-   Histogram of “Excellent” response values in the year 2002

``` r
brfss %>% 
  filter(year == 2002) %>% 
  ggplot(aes(x = excellent)) + 
  geom_histogram()
```

    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

![](p8105_hw2_hx2263_files/figure-markdown_github/unnamed-chunk-5-1.png)

``` r
  brfss %>% 
  filter(locationabbr == "NY") %>% 
  filter(locationdesc == "NY - New York County" | locationdesc == "NY - Queens County") %>% 
  ggplot(aes(x = year, y = excellent)) + 
  geom_point(aes(color = locationdesc))
```

![](p8105_hw2_hx2263_files/figure-markdown_github/unnamed-chunk-6-1.png)
